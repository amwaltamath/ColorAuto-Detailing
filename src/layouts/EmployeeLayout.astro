---
import '../styles/global.css';
import Layout from './Layout.astro';

interface Props {
  title: string;
  description?: string;
  keywords?: string[];
  canonical?: string;
  image?: string;
  noindex?: boolean;
}

const { title, description, keywords, canonical, image, noindex } = Astro.props;
---

<Layout title={title} description={description} keywords={keywords} canonical={canonical} image={image} noindex={noindex}>
  <div class="min-h-screen bg-slate-900">
    <!-- Employee Header -->
    <header class="bg-slate-800 shadow-lg border-b border-slate-700">
      <div class="max-w-7xl mx-auto px-4 py-4 flex flex-col gap-3">
        <div class="flex justify-between items-center">
          <div>
            <h1 class="text-2xl font-bold text-white">{title}</h1>
          </div>
          <div class="flex items-center space-x-2">
            <button id="logout-button" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition text-sm md:text-base">
              Logout
            </button>
          </div>
        </div>

        <nav class="flex gap-2 overflow-x-auto pb-1" aria-label="Employee navigation">
          <button class="nav-pill" data-tab="schedules">Schedules</button>
          <button class="nav-pill" data-tab="teams">Team</button>
          <button class="nav-pill" data-tab="messages">Messages</button>
          <button class="nav-pill" data-tab="chat">Chat</button>
          <button class="nav-pill" data-tab="profile">Profile</button>
        </nav>
      </div>
    </header>
    
    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-8">
      <slot />
    </main>
  </div>
</Layout>

<script is:inline>
  // Logout handler
  const logoutBtn = document.getElementById('logout-button');
  if (logoutBtn) {
    logoutBtn.addEventListener('click', () => {
      try {
        localStorage.removeItem('authToken');
      } catch (e) {
        console.error('Failed to clear auth token', e);
      }
      window.location.href = '/employee/login';
    });
  }

  // Tab navigation pills
  const navPills = Array.from(document.querySelectorAll('.nav-pill'));
  navPills.forEach((pill) => {
    pill.addEventListener('click', () => {
      const tab = pill.getAttribute('data-tab');
      if (window.switchTab && typeof window.switchTab === 'function') {
        window.switchTab(tab);
        window.scrollTo({ top: 0, behavior: 'smooth' });
      } else {
        window.location.href = `/employee/dashboard#${tab}`;
      }
    });
  });
</script>

<style>
  .nav-pill {
    @apply px-3 py-2 text-xs md:text-sm rounded-full border border-slate-600 bg-slate-700 text-slate-100 whitespace-nowrap hover:border-blue-500 hover:text-white transition;
  }
  .nav-pill:focus { outline: none; }
</style>
